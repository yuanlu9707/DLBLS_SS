s = load("HumanActivityTrain.mat");XTrain = s.XTrain;TTrain = s.YTrain;numObservations = numel(XTrain);classes = categories(TTrain{1});numClasses = numel(classes);numFeatures = size(s.XTrain{1},1);numFilters = 64;filterSize = 5;dropoutFactor = 0.005;numBlocks = 4;layer = [sequenceInputLayer(numFeatures,Normalization="rescale-symmetric",Name="input")    ];lgraph = layerGraph(layer);outputName = "input";for i = 1:numBlocks    dilationFactor = 2^(i-1);    name_cov1="conv1_"+i;    name_add="add_"+i;    layers = [        convolution1dLayer(filterSize,numFilters,DilationFactor=dilationFactor,Padding="causal",Name="conv1_"+i)        layerNormalizationLayer        reluLayer        spatialDropoutLayer(dropoutFactor)        convolution1dLayer(filterSize,numFilters,DilationFactor=dilationFactor,Padding="causal")        layerNormalizationLayer        reluLayer        spatialDropoutLayer(dropoutFactor)        convolution1dLayer(filterSize,numFilters,DilationFactor=dilationFactor,Padding="causal")        layerNormalizationLayer        reluLayer        spatialDropoutLayer(dropoutFactor,Name="se_input1"+i)        globalAveragePooling1dLayer(Name="avg1_1"+i)        fullyConnectedLayer(numFilters,Name="fc1_1"+i)        reluLayer        fullyConnectedLayer(numFilters,Name="fc1_2"+i)        sigmoidLayer(Name="sigmoid"+i)        functionLayer(@(X) dlarray(X,"CBT"),Formattable=true,Name="m1"+i)        multiplicationLayer(2,Name="multiplication"+i)        additionLayer(2,Name="add_"+i)        reluLayer(Name="block"+i)        ];    lgraph = addLayers(lgraph,layers);% Add and connect layers.    lgraph = connectLayers(lgraph,"se_input1"+i,"multiplication"+ i +"/in2");    lgraph = connectLayers(lgraph,outputName,"conv1_"+i);%     Skip connection.    if i == 1        % Include convolution in first skip connection.        layer = convolution1dLayer(1,numFilters,Name="convSkip");        lgraph = addLayers(lgraph,layer);        lgraph = connectLayers(lgraph,outputName,"convSkip");        lgraph = connectLayers(lgraph,"convSkip","add_" + i + "/in2");    else        lgraph = connectLayers(lgraph,outputName,"add_" + i + "/in2");    end        % Update layer output name.%     outputName = "add_" + i;    outputName = "block" + i;endlayers = [    fullyConnectedLayer(numClasses,Name="fc")    softmaxLayer    classificationLayer];lgraph = addLayers(lgraph,layers);lgraph = connectLayers(lgraph,outputName,"fc");figureplot(lgraph)title("SETCN")xlim([0.95 4.23])ylim([1.1 26.2])options = trainingOptions("adam", ...    MaxEpochs=40, ...    miniBatchSize=1, ...    Plots="training-progress", ...    Verbose=0);net = trainNetwork(XTrain,TTrain,lgraph,options);s = load("HumanActivityTest.mat");XTest = s.XTest;TTest = s.YTest;YPred = classify(net,XTest);accuracy = mean(YPred{1} == TTest{1})